#####################################################
# ENTREGA: FORMAL E INFORMAL
# AGRUPADO: RENDA
# ANOS: 2012 - 2024
# DADOS: RIO GRANDE DO SUL
#####################################################
options(timeout = 600) 
options(scipen = 999)
# install.packages("PNADcIBGE")
# install.packages("survey")
library(PNADcIBGE)
library(survey)
library(foreign)
library(srvyr)
library(reactable)
library(purrr)
#####################################################
#        CONFIGURANDO DIRETÓRIO DE DADOS
#####################################################
library(here)
here::set_here("C:/Users/fernanda-romeiro/OneDrive - Governo do Estado do Rio Grande do Sul/Projetos/PNAD/Dados_completos")

#####################################################
# 2012
#####################################################

load(file = here("Visitas","dadosPNADc1VISITA_2012.RData"))

dadosPNADc1VISITA_2012 <- dadosPNADc1VISITA_2012 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>% 
  
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_)
                ) 

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2012PR <- dadosPNADc1VISITA_2012 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2012PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2012PR)
dadosPNADc1VISITA_2012SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2012PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2012 <- dadosPNADc1VISITA_2012SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2012 <- dadosPNADc1VISITA_2012SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE))


########################################################
### Total de horas Efetivas
########################################################


table_3P_2012 <- dadosPNADc1VISITA_2012SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE
                                                           ))


########################################################
## Secundário 
## Pessoas Ocupadas
########################################################

dadosPNADc1VISITA_2012SEC <-  dadosPNADc1VISITA_2012 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2012SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2012SEC)
dadosPNADc1VISITA_2012SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2012SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2012 <- dadosPNADc1VISITA_2012SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################

########################################################
### Total de horas Habituais
########################################################


table_2S_2012 <- dadosPNADc1VISITA_2012SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE))

########################################################
### Total de horas Efetivas
########################################################


table_3S_2012 <- dadosPNADc1VISITA_2012SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2012 <- dadosPNADc1VISITA_2012SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2012 <- dadosPNADc1VISITA_2012SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2012 <- dadosPNADc1VISITA_2012SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE))

########################################################
### Secundário
########################################################
#### Total de Pessoas
########################################################

table_1TS_2012 <- dadosPNADc1VISITA_2012SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2012 <- dadosPNADc1VISITA_2012SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2012 <- dadosPNADc1VISITA_2012SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE))


########################################################
#### Renda 
########################################################

table_RP_2012 <- dadosPNADc1VISITA_2012SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
   # dplyr::filter(V40331 == "Em dinheiro") %>% 
   # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2012 <- dadosPNADc1VISITA_2012SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2013
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2013.RData"))

########################################################

dadosPNADc1VISITA_2013 <- dadosPNADc1VISITA_2013 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_)
                )



########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2013PR <- dadosPNADc1VISITA_2013 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2013PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2013PR)
dadosPNADc1VISITA_2013SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2013PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2013 <- dadosPNADc1VISITA_2013SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2013 <- dadosPNADc1VISITA_2013SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2013 <- dadosPNADc1VISITA_2013SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2013SEC <-  dadosPNADc1VISITA_2013 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2013SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2013SEC)
dadosPNADc1VISITA_2013SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2013SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2013 <- dadosPNADc1VISITA_2013SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2S_2013 <- dadosPNADc1VISITA_2013SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2013 <- dadosPNADc1VISITA_2013SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2013 <- dadosPNADc1VISITA_2013SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2013 <- dadosPNADc1VISITA_2013SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2013 <- dadosPNADc1VISITA_2013SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2013 <- dadosPNADc1VISITA_2013SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2013 <- dadosPNADc1VISITA_2013SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE))

########################################################
#### Total de horas Efetivas
########################################################


table_3TS_2013 <- dadosPNADc1VISITA_2013SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE))
########################################################
#### Renda 
########################################################

table_RP_2013 <- dadosPNADc1VISITA_2013SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2013 <- dadosPNADc1VISITA_2013SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2014
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2014.RData"))

dadosPNADc1VISITA_2014 <- dadosPNADc1VISITA_2014 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>% 
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                                   (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                                   (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                                   (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                                   (V4012 == "Empregador" & V4032 == "Sim") |
                                                   (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                                 
                                                 
                                                 (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                                   (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                                   (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                                   (V4012 == "Empregador" & V4032 == "Não") |
                                                   (V4012 == "Conta própria" & V4032 == "Não") |
                                                   (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                                 
                                                 .default = NA_character_),
                      SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                                    (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                                    (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                                    (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                                    (V4043 == "Empregador" & V4049 == "Sim") |
                                                    (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                                  
                                                  
                                                  (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                                    (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                                    (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                                    (V4043 == "Empregador" & V4049 == "Não") |
                                                    (V4043 == "Conta própria" & V4049 == "Não") |
                                                    (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                                  
                                                  .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2014PR <- dadosPNADc1VISITA_2014 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2014PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2014PR)
dadosPNADc1VISITA_2014SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2014PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2014 <- dadosPNADc1VISITA_2014SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2014 <- dadosPNADc1VISITA_2014SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2014 <- dadosPNADc1VISITA_2014SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2014SEC <-  dadosPNADc1VISITA_2014 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2014SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2014SEC)
dadosPNADc1VISITA_2014SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2014SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2014 <- dadosPNADc1VISITA_2014SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2014 <- dadosPNADc1VISITA_2014SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3S_2014 <- dadosPNADc1VISITA_2014SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2014 <- dadosPNADc1VISITA_2014SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2014 <- dadosPNADc1VISITA_2014SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2014 <- dadosPNADc1VISITA_2014SRPR %>%
  dplyr::filter(VD4032 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4032,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2014 <- dadosPNADc1VISITA_2014SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################


table_2TS_2014 <- dadosPNADc1VISITA_2014SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2014 <- dadosPNADc1VISITA_2014SRSEC %>%  
  dplyr::filter(VD4033 != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(VD4033,
                                                           na.rm = TRUE
                                                           ))
########################################################
#### Renda 
########################################################

table_RP_2014 <- dadosPNADc1VISITA_2014SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2014 <- dadosPNADc1VISITA_2014SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2015
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2015.RData"))

dadosPNADc1VISITA_2015 <- dadosPNADc1VISITA_2015 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  #ANO 2015 USAR:
  dplyr::mutate(V4039C = base::ifelse(is.na(V4039C),
                                      VD4032,
                                      V4039C),
                V4056C = base::ifelse(is.na(V4056C),
                                      VD4033,
                                      V4056C)) %>% 
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2015PR <- dadosPNADc1VISITA_2015 %>% 
  dplyr::filter(!(is.na(V4013)))  

dadosPNADc1VISITA_2015PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2015PR)
dadosPNADc1VISITA_2015SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2015PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2015 <- dadosPNADc1VISITA_2015SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2P_2015 <- dadosPNADc1VISITA_2015SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2015 <- dadosPNADc1VISITA_2015SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################

dadosPNADc1VISITA_2015SEC <-  dadosPNADc1VISITA_2015 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2015SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2015SEC)
dadosPNADc1VISITA_2015SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2015SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2015 <- dadosPNADc1VISITA_2015SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2S_2015 <- dadosPNADc1VISITA_2015SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2015 <- dadosPNADc1VISITA_2015SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2015 <- dadosPNADc1VISITA_2015SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################

table_2TP_2015 <- dadosPNADc1VISITA_2015SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2015 <- dadosPNADc1VISITA_2015SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2015 <- dadosPNADc1VISITA_2015SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2015 <- dadosPNADc1VISITA_2015SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2015 <- dadosPNADc1VISITA_2015SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2015 <- dadosPNADc1VISITA_2015SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2015 <- dadosPNADc1VISITA_2015SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2016
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2016.RData"))

dadosPNADc1VISITA_2016 <- dadosPNADc1VISITA_2016 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>% 
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2016PR <- dadosPNADc1VISITA_2016 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2016PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2016PR)
dadosPNADc1VISITA_2016SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2016PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2016 <- dadosPNADc1VISITA_2016SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2P_2016 <- dadosPNADc1VISITA_2016SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2016 <- dadosPNADc1VISITA_2016SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################

dadosPNADc1VISITA_2016SEC <-  dadosPNADc1VISITA_2016 %>% 
  dplyr::filter(!(is.na(V4044))) 

dadosPNADc1VISITA_2016SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2016SEC)
dadosPNADc1VISITA_2016SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2016SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2016 <- dadosPNADc1VISITA_2016SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2S_2016 <- dadosPNADc1VISITA_2016SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2016 <- dadosPNADc1VISITA_2016SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2016 <- dadosPNADc1VISITA_2016SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2016 <- dadosPNADc1VISITA_2016SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2016 <- dadosPNADc1VISITA_2016SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2016 <- dadosPNADc1VISITA_2016SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2016 <- dadosPNADc1VISITA_2016SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))
########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2016 <- dadosPNADc1VISITA_2016SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2016 <- dadosPNADc1VISITA_2016SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2016 <- dadosPNADc1VISITA_2016SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2017
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2017.RData"))

dadosPNADc1VISITA_2017 <- dadosPNADc1VISITA_2017 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2017PR <- dadosPNADc1VISITA_2017 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2017PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2017PR)
dadosPNADc1VISITA_2017SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2017PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2017 <- dadosPNADc1VISITA_2017SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2017 <- dadosPNADc1VISITA_2017SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2017 <- dadosPNADc1VISITA_2017SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2017SEC <-  dadosPNADc1VISITA_2017 %>% 
  dplyr::filter(!(is.na(V4044)))   

dadosPNADc1VISITA_2017SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2017SEC)
dadosPNADc1VISITA_2017SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2017SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2017 <- dadosPNADc1VISITA_2017SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2S_2017 <- dadosPNADc1VISITA_2017SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3S_2017 <- dadosPNADc1VISITA_2017SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2017 <- dadosPNADc1VISITA_2017SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################

table_2TP_2017 <- dadosPNADc1VISITA_2017SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2017 <- dadosPNADc1VISITA_2017SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2017 <- dadosPNADc1VISITA_2017SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2017 <- dadosPNADc1VISITA_2017SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2017 <- dadosPNADc1VISITA_2017SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))
########################################################
#### Renda 
########################################################

table_RP_2017 <- dadosPNADc1VISITA_2017SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2017 <- dadosPNADc1VISITA_2017SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))


########################################################
# 2018
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2018.RData"))

dadosPNADc1VISITA_2018 <- dadosPNADc1VISITA_2018 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre,
                                         levels = c("1", "2", "3", "4"))) %>% 
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2018PR <- dadosPNADc1VISITA_2018 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2018PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2018PR)
dadosPNADc1VISITA_2018SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2018PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2018 <- dadosPNADc1VISITA_2018SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2018 <- dadosPNADc1VISITA_2018SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3P_2018 <- dadosPNADc1VISITA_2018SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################

dadosPNADc1VISITA_2018SEC <-  dadosPNADc1VISITA_2018 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2018SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2018SEC)
dadosPNADc1VISITA_2018SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2018SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2018 <- dadosPNADc1VISITA_2018SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2018 <- dadosPNADc1VISITA_2018SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3S_2018 <- dadosPNADc1VISITA_2018SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2018 <- dadosPNADc1VISITA_2018SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2018 <- dadosPNADc1VISITA_2018SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2018 <- dadosPNADc1VISITA_2018SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2018 <- dadosPNADc1VISITA_2018SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2018 <- dadosPNADc1VISITA_2018SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2018 <- dadosPNADc1VISITA_2018SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))
########################################################
#### Renda 
########################################################

table_RP_2018 <- dadosPNADc1VISITA_2018SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2018 <- dadosPNADc1VISITA_2018SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2019
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2019.RData"))


dadosPNADc1VISITA_2019 <- dadosPNADc1VISITA_2019 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2019PR <- dadosPNADc1VISITA_2019 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2019PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2019PR)
dadosPNADc1VISITA_2019SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2019PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2019 <- dadosPNADc1VISITA_2019SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2P_2019 <- dadosPNADc1VISITA_2019SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2019 <- dadosPNADc1VISITA_2019SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2019SEC <-  dadosPNADc1VISITA_2019 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2019SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2019SEC)
dadosPNADc1VISITA_2019SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2019SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2019 <- dadosPNADc1VISITA_2019SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2019 <- dadosPNADc1VISITA_2019SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3S_2019 <- dadosPNADc1VISITA_2019SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2019 <- dadosPNADc1VISITA_2019SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2019 <- dadosPNADc1VISITA_2019SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2019 <- dadosPNADc1VISITA_2019SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2019 <- dadosPNADc1VISITA_2019SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################


table_2TS_2019 <- dadosPNADc1VISITA_2019SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2019 <- dadosPNADc1VISITA_2019SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))
########################################################
#### Renda 
########################################################

table_RP_2019 <- dadosPNADc1VISITA_2019SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2019 <- dadosPNADc1VISITA_2019SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2020
########################################################


load(file = here("Visitas","dadosPNADc5VISITA_2020.RData"))

dadosPNADc5VISITA_2020 <- dadosPNADc5VISITA_2020 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  )  %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc5VISITA_2020PR <- dadosPNADc5VISITA_2020 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc5VISITA_2020PR  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2020PR)
dadosPNADc5VISITA_2020SRPR <- srvyr::as_survey(dadosPNADc5VISITA_2020PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2020 <- dadosPNADc5VISITA_2020SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2020 <- dadosPNADc5VISITA_2020SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))


########################################################
### Total de horas Efetivas
########################################################


table_3P_2020 <- dadosPNADc5VISITA_2020SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc5VISITA_2020SEC <-  dadosPNADc5VISITA_2020 %>% 
  dplyr::filter(!(is.na(V4044)))   

dadosPNADc5VISITA_2020SEC  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2020SEC)
dadosPNADc5VISITA_2020SRSEC <- srvyr::as_survey(dadosPNADc5VISITA_2020SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2020 <- dadosPNADc5VISITA_2020SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################

table_2S_2020 <- dadosPNADc5VISITA_2020SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2020 <- dadosPNADc5VISITA_2020SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2020 <- dadosPNADc5VISITA_2020SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################

table_2TP_2020 <- dadosPNADc5VISITA_2020SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2020 <- dadosPNADc5VISITA_2020SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2020 <- dadosPNADc5VISITA_2020SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2020 <- dadosPNADc5VISITA_2020SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2020 <- dadosPNADc5VISITA_2020SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2020 <- dadosPNADc5VISITA_2020SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2020 <- dadosPNADc5VISITA_2020SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2021
########################################################

load(file = here("Visitas","dadosPNADc5VISITA_2021.RData"))

dadosPNADc5VISITA_2021 <- dadosPNADc5VISITA_2021 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc5VISITA_2021PR <- dadosPNADc5VISITA_2021 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc5VISITA_2021PR  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2021PR)
dadosPNADc5VISITA_2021SRPR <- srvyr::as_survey(dadosPNADc5VISITA_2021PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2021 <- dadosPNADc5VISITA_2021SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2021 <- dadosPNADc5VISITA_2021SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2021 <- dadosPNADc5VISITA_2021SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc5VISITA_2021SEC <-  dadosPNADc5VISITA_2021 %>% 
  dplyr::filter(!(is.na(V4044))) 

dadosPNADc5VISITA_2021SEC  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2021SEC)
dadosPNADc5VISITA_2021SRSEC <- srvyr::as_survey(dadosPNADc5VISITA_2021SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2021 <- dadosPNADc5VISITA_2021SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2021 <- dadosPNADc5VISITA_2021SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2021 <- dadosPNADc5VISITA_2021SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2021 <- dadosPNADc5VISITA_2021SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2021 <- dadosPNADc5VISITA_2021SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2021 <- dadosPNADc5VISITA_2021SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2021 <- dadosPNADc5VISITA_2021SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2021 <- dadosPNADc5VISITA_2021SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2021 <- dadosPNADc5VISITA_2021SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))
########################################################
#### Renda 
########################################################

table_RP_2021 <- dadosPNADc5VISITA_2021SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2021 <- dadosPNADc5VISITA_2021SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2022
########################################################

load(file = here("Visitas","dadosPNADc5VISITA_2022.RData"))

dadosPNADc5VISITA_2022 <- dadosPNADc5VISITA_2022 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>% 
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc5VISITA_2022PR <- dadosPNADc5VISITA_2022 %>% 
  dplyr::filter(!(is.na(V4013)))  

dadosPNADc5VISITA_2022PR  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2022PR)
dadosPNADc5VISITA_2022SRPR <- srvyr::as_survey(dadosPNADc5VISITA_2022PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2022 <- dadosPNADc5VISITA_2022SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2022 <- dadosPNADc5VISITA_2022SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))


########################################################
### Total de horas Efetivas
########################################################


table_3P_2022 <- dadosPNADc5VISITA_2022SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc5VISITA_2022SEC <-  dadosPNADc5VISITA_2022 %>% 
  dplyr::filter(!(is.na(V4044)))   

dadosPNADc5VISITA_2022SEC  <- PNADcIBGE::pnadc_design(dadosPNADc5VISITA_2022SEC)
dadosPNADc5VISITA_2022SRSEC <- srvyr::as_survey(dadosPNADc5VISITA_2022SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2022 <- dadosPNADc5VISITA_2022SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())


########################################################
### Total de horas Habituais
########################################################


table_2S_2022 <- dadosPNADc5VISITA_2022SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


########################################################
table_3S_2022 <- dadosPNADc5VISITA_2022SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2022 <- dadosPNADc5VISITA_2022SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################

table_2TP_2022 <- dadosPNADc5VISITA_2022SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2022 <- dadosPNADc5VISITA_2022SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2022 <- dadosPNADc5VISITA_2022SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################


table_2TS_2022 <- dadosPNADc5VISITA_2022SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################


table_3TS_2022 <- dadosPNADc5VISITA_2022SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2022 <- dadosPNADc5VISITA_2022SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2022 <- dadosPNADc5VISITA_2022SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))

########################################################
# 2023
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2023.RData"))

dadosPNADc1VISITA_2023 <- dadosPNADc1VISITA_2023 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>%
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2023PR <- dadosPNADc1VISITA_2023 %>% 
  dplyr::filter(!(is.na(V4013))) 

dadosPNADc1VISITA_2023PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2023PR)
dadosPNADc1VISITA_2023SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2023PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2023 <- dadosPNADc1VISITA_2023SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2023 <- dadosPNADc1VISITA_2023SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))


########################################################
### Total de horas Efetivas
########################################################


table_3P_2023 <- dadosPNADc1VISITA_2023SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2023SEC <-  dadosPNADc1VISITA_2023 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2023SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2023SEC)
dadosPNADc1VISITA_2023SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2023SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2023 <- dadosPNADc1VISITA_2023SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2023 <- dadosPNADc1VISITA_2023SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2023 <- dadosPNADc1VISITA_2023SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2023 <- dadosPNADc1VISITA_2023SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2023 <- dadosPNADc1VISITA_2023SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2023 <- dadosPNADc1VISITA_2023SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2023 <- dadosPNADc1VISITA_2023SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################


table_2TS_2023 <- dadosPNADc1VISITA_2023SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2023 <- dadosPNADc1VISITA_2023SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2023 <- dadosPNADc1VISITA_2023SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2023 <- dadosPNADc1VISITA_2023SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))


########################################################
# 2024
########################################################

load(file = here("Visitas","dadosPNADc1VISITA_2024.RData"))

dadosPNADc1VISITA_2024 <- dadosPNADc1VISITA_2024 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>% 
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3", "4"))) %>% 
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_2024PR <- dadosPNADc1VISITA_2024 %>% 
  dplyr::filter(!(is.na(V4013)))  

dadosPNADc1VISITA_2024PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2024PR)
dadosPNADc1VISITA_2024SRPR <- srvyr::as_survey(dadosPNADc1VISITA_2024PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2024 <- dadosPNADc1VISITA_2024SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2024 <- dadosPNADc1VISITA_2024SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2024 <- dadosPNADc1VISITA_2024SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_2024SEC <-  dadosPNADc1VISITA_2024 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_2024SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_2024SEC)
dadosPNADc1VISITA_2024SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_2024SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2024 <- dadosPNADc1VISITA_2024SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())


########################################################
### Total de horas Habituais
########################################################


table_2S_2024 <- dadosPNADc1VISITA_2024SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2024 <- dadosPNADc1VISITA_2024SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2024 <- dadosPNADc1VISITA_2024SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################

table_2TP_2024 <- dadosPNADc1VISITA_2024SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2024 <- dadosPNADc1VISITA_2024SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2024 <- dadosPNADc1VISITA_2024SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################


table_2TS_2024 <- dadosPNADc1VISITA_2024SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2024 <- dadosPNADc1VISITA_2024SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2024 <- dadosPNADc1VISITA_2024SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2024 <- dadosPNADc1VISITA_2024SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))


########################################################
# 2025



load(file = "C:/Users/fernanda-romeiro/OneDrive - Governo do Estado do Rio Grande do Sul/Projetos/PNAD/Dados_completos/Trimestre/dadosPNADc1VISITA_25.RData")

dadosPNADc1VISITA_25 <- dadosPNADc1VISITA_25 %>% 
  dplyr::filter(UF == "Rio Grande do Sul" & VD4002 == "Pessoas ocupadas") %>%
  dplyr::mutate(Trimestre = base::factor(Trimestre, levels = c("1", "2", "3"))) %>% 
  
  dplyr::mutate(cod_SCN_PR =  dplyr::case_when(V4013 %in% c("01101","01102","01103","01104","01105",
                                                            "01106","01107","01108","01109","01110",
                                                            "01111","01112","01113","01114","01115",
                                                            "01116","01117","01118","01119","01201",
                                                            "01202","01203","01204","01205","01206",
                                                            "01207","01208","01209","01401","01402",
                                                            "01500","01999","02000","03001","03002") ~ 1,
                                               
                                               V4013 %in% c("05000","06000","07001","07002","08001",
                                                            "08002","08009","09000") ~ 2,
                                               
                                               V4013 %in% c("10010","10021","10022","10030","10091",
                                                            "10092","10093","10099","11000","12000",
                                                            "13001","13002","14001","14002","15011",
                                                            "15012","15020","16001","16002","17001",
                                                            "17002","18000","19010","19020","19030",
                                                            "20010","20020","20090","21000","22010",
                                                            "22020","23010","23091","23099","24001",
                                                            "24002","24003","25001","25002","26010",
                                                            "26020","26030","26041","26042","27010",
                                                            "27090","28000","29001","29002","29003",
                                                            "30010","30020","30030","30090","31000",
                                                            "32001","32002","32003","32009","33001","33002") ~ 3,
                                               
                                               V4013 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
                                               
                                               V4013 %in% c("41000","42000","43000") ~ 5,
                                               
                                               V4013 %in% c("45010","45020","45030","45040","48010",
                                                            "48020","48030","48041","48042","48050",
                                                            "48060","48071","48072","48073","48074",
                                                            "48075","48076","48077","48078","48079",
                                                            "48080","48090","48100") ~ 6,
                                               
                                               V4013 %in% c("49010","49030","49040","49090","50000",
                                                            "51000","52010","52020","53001","53002") ~ 7,
                                               
                                               V4013 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
                                               
                                               V4013 %in% c("64000","65000","66001","66002") ~ 9,
                                               
                                               V4013 == "68000" ~ 10,
                                               
                                               #######################################################
                                               V4013 %in% c("55000","56011","56012","56020","69000",
                                                            "70000","71000","72000","73010","73020",
                                                            "74000","75000","77010","77020","78000",
                                                            "79000","80000","81011","81012","81020",
                                                            "82001","82002","82003","82009","90000",
                                                            "91000","92000","93011","93012","93020",
                                                            "94010","94020","94091","94099","95010",
                                                            "95030","96010","96020","96030","96090",
                                                            "97000") ~ 11,
                                               
                                               V4012 == "Trabalhador doméstico" & V4013 %in% c("85011","85012","85013",
                                                                                               "85014","85021","85029",
                                                                                               "86001","86002","86003",
                                                                                               "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregado do setor privado" & V4013 %in% c("85011","85012","85013",
                                                                                                    "85014","85021","85029",
                                                                                                    "86001","86002","86003",
                                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Empregador" & V4013 %in% c("85011","85012","85013",
                                                                                    "85014","85021","85029",
                                                                                    "86001","86002","86003",
                                                                                    "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Conta própria" & V4013 %in% c("85011","85012","85013",
                                                                                       "85014","85021","85029",
                                                                                       "86001","86002","86003",
                                                                                       "86004","86009","87000","88000") ~ 11,
                                               V4012 == "Trabalhador familiar não remunerado" & V4013 %in% c("85011","85012","85013",
                                                                                                             "85014","85021","85029",
                                                                                                             "86001","86002","86003",
                                                                                                             "86004","86009","87000","88000") ~ 11,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
                                               
                                               V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4013 %in% c("85011","85012","85013",
                                                                                                                                                                              "85014","85021","85029",
                                                                                                                                                                              "86001","86002","86003",
                                                                                                                                                                              "86004","86009","87000",
                                                                                                                                                                              "88000") ~ 12,
                                               V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4013 %in% c("85011","85012","85013",
                                                                                                                                           "85014","85021","85029",
                                                                                                                                           "86001","86002","86003",
                                                                                                                                           "86004","86009","87000","88000") ~ 12,
                                               
                                               ########################################################
                                               
                                               V4013 %in% c("99000","00000") ~ 0,
                                               
                                               .default = NA_integer_)
  )  %>% 
  
  dplyr::mutate(cod_SCN_SEC =  dplyr::case_when(V4044 %in% c(
    "01101","01102","01103","01104","01105",
    "01106","01107","01108","01109","01110",
    "01111","01112","01113","01114","01115",
    "01116","01117","01118","01119","01201",
    "01202","01203","01204","01205","01206",
    "01207","01208","01209","01401","01402",
    "01500","01999","02000","03001","03002") ~ 1,
    
    V4044 %in% c("05000","06000","07001","07002","08001","08002","08009","09000") ~ 2,
    
    V4044 %in% c("10010","10021","10022","10030","10091",
                 "10092","10093","10099","11000","12000",
                 "13001","13002","14001","14002","15011",
                 "15012","15020","16001","16002","17001",
                 "17002","18000","19010","19020","19030",
                 "20010","20020","20090","21000","22010",
                 "22020","23010","23091","23099","24001",
                 "24002","24003","25001","25002","26010",
                 "26020","26030","26041","26042","27010",
                 "27090","28000","29001","29002","29003",
                 "30010","30020","30030","30090","31000",
                 "32001","32002","32003","32009","33001","33002") ~ 3,
    
    V4044 %in% c("35010","35021","35022","36000","37000","38000","39000") ~ 4,
    
    V4044 %in% c("41000","42000","43000") ~ 5,
    
    V4044 %in% c("45010","45020","45030","45040","48010",
                 "48020","48030","48041","48042","48050",
                 "48060","48071","48072","48073","48074",
                 "48075","48076","48077","48078","48079",
                 "48080","48090","48100") ~ 6,
    
    
    V4044 %in% c("49010","49030","49040","49090","50000",
                 "51000","52010","52020","53001","53002") ~ 7,
    
    V4044 %in% c("58000","59000","60001","60002","61000","62000","63000") ~ 8,
    
    V4044 %in% c("64000","65000","66001","66002") ~ 9,
    
    V4044 == "68000" ~ 10,
    
    
    ###################################################################
    
    V4044 %in% c(
      "55000","56011","56012","56020","69000",
      "70000","71000","72000","73010","73020",
      "74000","75000","77010","77020","78000",
      "79000","80000","81011","81012","81020",
      "82001","82002","82003","82009","90000",
      "91000","92000","93011","93012","93020",
      "94010","94020","94091","94099","95010",
      "95030","96010","96020","96030","96090",
      "97000") ~ 11,
    
    
    
    V4043 == "Trabalhador doméstico" & V4044 %in% c("85011","85012","85013",
                                                    "85014","85021", "85029",
                                                    "86001","86002","86003",
                                                    "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregado do setor privado" & V4044 %in% c("85011","85012","85013",
                                                         "85014","85021", "85029",
                                                         "86001","86002","86003",
                                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Empregador" & V4044 %in% c("85011","85012","85013",
                                         "85014","85021", "85029",
                                         "86001","86002","86003",
                                         "86004","86009","87000","88000") ~ 11,
    V4043 == "Conta própria" & V4044 %in% c("85011","85012","85013",
                                            "85014","85021", "85029",
                                            "86001","86002","86003",
                                            "86004","86009","87000","88000") ~ 11,
    V4043 == "Trabalhador não remunerado em ajuda a membro do domicílio ou parente" & V4044 %in% c("85011","85012","85013",
                                                                                                   "85014","85021", "85029",
                                                                                                   "86001","86002","86003",
                                                                                                   "86004","86009","87000","88000") ~ 11,
    
    
    ####################################################################
    
    V4044 %in% c("84011","84012","84013","84014","84015","84016","84017","84020") ~ 12,
    
    V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar" & V4044 %in% c("85011","85012","85013",
                                                                                                                                   "85014","85021","85029",
                                                                                                                                   "86001","86002","86003",
                                                                                                                                   "86004","86009","87000",
                                                                                                                                   "88000") ~ 12,
    V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4044 %in% c("85011","85012","85013",
                                                                                                "85014","85021","85029",
                                                                                                "86001","86002","86003",
                                                                                                "86004","86009","87000","88000") ~ 12,
    
    ########################################################
    
    V4044 %in% c("99000","00000") ~ 0,
    
    .default = NA_integer_)
  ) %>% 
  dplyr::mutate(SIT_PR = dplyr::case_when( (V4012 == "Trabalhador doméstico" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Sim") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Sim") |
                                             (V4012 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                             (V4012 == "Empregador" & V4032 == "Sim") |
                                             (V4012 == "Conta própria" & V4032 == "Sim") ~ "Formal",
                                           
                                           
                                           (V4012 == "Trabalhador doméstico" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor privado" & V4029 == "Não") |
                                             (V4012 == "Empregado do setor público (inclusive empresas de economia mista)" & V4029 == "Não") |
                                             (V4012 == "Empregador" & V4032 == "Não") |
                                             (V4012 == "Conta própria" & V4032 == "Não") |
                                             (V4012 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                           
                                           .default = NA_character_),
                SIT_SEC = dplyr::case_when( (V4043 == "Trabalhador doméstico" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Sim") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Sim") |
                                              (V4043 == "Militar do exército, da marinha, da aeronáutica, da polícia militar ou do corpo de bombeiros militar") |
                                              (V4043 == "Empregador" & V4049 == "Sim") |
                                              (V4043 == "Conta própria" & V4049 == "Sim") ~ "Formal",
                                            
                                            
                                            (V4043 == "Trabalhador doméstico" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor privado" & V4048 == "Não") |
                                              (V4043 == "Empregado do setor público (inclusive empresas de economia mista)" & V4048 == "Não") |
                                              (V4043 == "Empregador" & V4049 == "Não") |
                                              (V4043 == "Conta própria" & V4049 == "Não") |
                                              (V4043 == "Trabalhador familiar não remunerado")  ~ "Informal",
                                            
                                            .default = NA_character_))

########################################################
## Principal
## Pessoas ocupadas
########################################################

dadosPNADc1VISITA_25PR <- dadosPNADc1VISITA_25 %>% 
  dplyr::filter(!(is.na(V4013)))  

dadosPNADc1VISITA_25PR  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_25PR)
dadosPNADc1VISITA_25SRPR <- srvyr::as_survey(dadosPNADc1VISITA_25PR)

########################################################
### Total de Pessoas
########################################################

table_1P_2025 <- dadosPNADc1VISITA_25SRPR %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2P_2025 <- dadosPNADc1VISITA_25SRPR %>%  
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################


table_3P_2025 <- dadosPNADc1VISITA_25SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Secundário 
## Pessoas Ocupadas
########################################################


dadosPNADc1VISITA_25SEC <-  dadosPNADc1VISITA_25 %>% 
  dplyr::filter(!(is.na(V4044)))  

dadosPNADc1VISITA_25SEC  <- PNADcIBGE::pnadc_design(dadosPNADc1VISITA_25SEC)
dadosPNADc1VISITA_25SRSEC <- srvyr::as_survey(dadosPNADc1VISITA_25SEC)

########################################################
### Total de Pessoas
########################################################

table_1S_2025 <- dadosPNADc1VISITA_25SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
### Total de horas Habituais
########################################################


table_2S_2025 <- dadosPNADc1VISITA_25SRSEC %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))

########################################################
### Total de horas Efetivas
########################################################

table_3S_2025 <- dadosPNADc1VISITA_25SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
## Total
### Principal
#### Pessoas Ocupadas
########################################################

table_1TP_2025 <- dadosPNADc1VISITA_25SRPR %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Horas Habituais
########################################################


table_2TP_2025 <- dadosPNADc1VISITA_25SRPR %>%  
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4039,
                                                            na.rm = TRUE
                                                            ))

########################################################
#### Horas Efetivas
########################################################

table_3TP_2025 <- dadosPNADc1VISITA_25SRPR %>%
  dplyr::filter(V4039C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4039C,
                                                           na.rm = TRUE
                                                           ))

########################################################
### Secundário
#### Total de Pessoas
########################################################

table_1TS_2025 <- dadosPNADc1VISITA_25SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total())

########################################################
#### Total de horas Habituais
########################################################

table_2TS_2025 <- dadosPNADc1VISITA_25SRSEC %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasHabituais = srvyr::survey_total(V4056,
                                                            na.rm = TRUE
                                                            ))
########################################################
#### Total de horas Efetivas
########################################################

table_3TS_2025 <- dadosPNADc1VISITA_25SRSEC %>%  
  dplyr::filter(V4056C != 0) %>% 
  dplyr::group_by(Ano) %>% 
  dplyr::summarise(Qtd_horasEfetivas = srvyr::survey_total(V4056C,
                                                           na.rm = TRUE
                                                           ))

########################################################
#### Renda 
########################################################

table_RP_2025 <- dadosPNADc1VISITA_25SRPR %>%  
  dplyr::filter(VD4017 != 0) %>% 
  # dplyr::filter(V40331 == "Em dinheiro") %>% 
  # dplyr::filter(V40332 == "Em produtos ou mercadorias") %>% 
  dplyr::group_by(V4013, SIT_PR, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_P = srvyr::survey_total(VD4017,
                                                     na.rm = TRUE))

table_RS_2025 <- dadosPNADc1VISITA_25SRSEC %>%
  dplyr::mutate(Qtd_renda_S = base::sum(V405112, V405122, na.rm = TRUE)) %>% 
  dplyr::filter(Qtd_renda_S != 0) %>% 
  dplyr::group_by(V4044, SIT_SEC, Ano) %>% 
  dplyr::summarise(freq = srvyr::survey_total(),
                   Qtd_renda_S = srvyr::survey_total(Qtd_renda_S,
                                                     na.rm = TRUE))


# Empilhamento


table_1TP <- dplyr::bind_rows(table_1TP_2012,
                              table_1TP_2013,
                              table_1TP_2014,
                              table_1TP_2015,
                              table_1TP_2016,
                              table_1TP_2017,
                              table_1TP_2018,
                              table_1TP_2019,
                              table_1TP_2020,
                              table_1TP_2021,
                              table_1TP_2022,
                              table_1TP_2023,
                              table_1TP_2024,
                              table_1TP_2025
)   

table_2TP <- dplyr::bind_rows(table_2TP_2012,
                              table_2TP_2013,
                              table_2TP_2014,
                              table_2TP_2015,
                              table_2TP_2016,
                              table_2TP_2017,
                              table_2TP_2018,
                              table_2TP_2019,
                              table_2TP_2020,
                              table_2TP_2021,
                              table_2TP_2022,
                              table_2TP_2023,
                              table_2TP_2024,
                              table_2TP_2025
)

table_3TP <- dplyr::bind_rows(table_3TP_2012,
                              table_3TP_2013,
                              table_3TP_2014,
                              table_3TP_2015,
                              table_3TP_2016,
                              table_3TP_2017,
                              table_3TP_2018,
                              table_3TP_2019,
                              table_3TP_2020,
                              table_3TP_2021,
                              table_3TP_2022,
                              table_3TP_2023,
                              table_3TP_2024,
                              table_3TP_2025
)  

table_1TS <- dplyr::bind_rows(table_1TS_2012,
                              table_1TS_2013,
                              table_1TS_2014,
                              table_1TS_2015,
                              table_1TS_2016,
                              table_1TS_2017,
                              table_1TS_2018,
                              table_1TS_2019,
                              table_1TS_2020,
                              table_1TS_2021,
                              table_1TS_2022,
                              table_1TS_2023,
                              table_1TS_2024,
                              table_1TS_2025
)  

table_2TS <- dplyr::bind_rows(table_2TS_2012,
                              table_2TS_2013,
                              table_2TS_2014,
                              table_2TS_2015,
                              table_2TS_2016,
                              table_2TS_2017,
                              table_2TS_2018,
                              table_2TS_2019,
                              table_2TS_2020,
                              table_2TS_2021,
                              table_2TS_2022,
                              table_2TS_2023,
                              table_2TS_2024,
                              table_2TS_2025
)  

table_3TS <- dplyr::bind_rows(table_3TS_2012,
                              table_3TS_2013,
                              table_3TS_2014,
                              table_3TS_2015,
                              table_3TS_2016,
                              table_3TS_2017,
                              table_3TS_2018,
                              table_3TS_2019,
                              table_3TS_2020,
                              table_3TS_2021,
                              table_3TS_2022,
                              table_3TS_2023,
                              table_3TS_2024,
                              table_3TS_2025
)

table_1P <- dplyr::bind_rows(table_1P_2012,
                             table_1P_2013,
                             table_1P_2014,
                             table_1P_2015,
                             table_1P_2016,
                             table_1P_2017,
                             table_1P_2018,
                             table_1P_2019,
                             table_1P_2020,
                             table_1P_2021,
                             table_1P_2022,
                             table_1P_2023,
                             table_1P_2024,
                             table_1P_2025
)

table_2P <- dplyr::bind_rows( table_2P_2012,
                              table_2P_2013,
                              table_2P_2014,
                              table_2P_2015,
                              table_2P_2016,
                              table_2P_2017,
                              table_2P_2018,
                              table_2P_2019,
                              table_2P_2020,
                              table_2P_2021,
                              table_2P_2022,
                              table_2P_2023,
                              table_2P_2024,
                              table_2P_2025
)

table_3P <- dplyr::bind_rows(table_3P_2012,
                             table_3P_2013,
                             table_3P_2014,
                             table_3P_2015,
                             table_3P_2016,
                             table_3P_2017,
                             table_3P_2018,
                             table_3P_2019,
                             table_3P_2020,
                             table_3P_2021,
                             table_3P_2022,
                             table_3P_2023,
                             table_3P_2024,
                             table_3P_2025
)


table_1S <- dplyr::bind_rows(table_1S_2012,
                             table_1S_2013,
                             table_1S_2014,
                             table_1S_2015,
                             table_1S_2016,
                             table_1S_2017,
                             table_1S_2018,
                             table_1S_2019,
                             table_1S_2020,
                             table_1S_2021,
                             table_1S_2022,
                             table_1S_2023,
                             table_1S_2024,
                             table_1S_2025
)

table_2S <- dplyr::bind_rows(table_2S_2012,
                             table_2S_2013,
                             table_2S_2014,
                             table_2S_2015,
                             table_2S_2016,
                             table_2S_2017,
                             table_2S_2018,
                             table_2S_2019,
                             table_2S_2020,
                             table_2S_2021,
                             table_2S_2022,
                             table_2S_2023,
                             table_2S_2024,
                             table_2S_2025
)

table_3S <- dplyr::bind_rows(table_3S_2012,
                             table_3S_2013,
                             table_3S_2014,
                             table_3S_2015,
                             table_3S_2016,
                             table_3S_2017,
                             table_3S_2018,
                             table_3S_2019,
                             table_3S_2020,
                             table_3S_2021,
                             table_3S_2022,
                             table_3S_2023,
                             table_3S_2024,
                             table_3S_2025)

table_RP <- dplyr::bind_rows(table_RP_2012,
                             table_RP_2013,
                             table_RP_2014,
                             table_RP_2015,
                             table_RP_2016,
                             table_RP_2017,
                             table_RP_2018,
                             table_RP_2019,
                             table_RP_2020,
                             table_RP_2021,
                             table_RP_2022,
                             table_RP_2023,
                             table_RP_2024,
                             table_RP_2025)



table_RS <- dplyr::bind_rows(table_RS_2012,
                             table_RS_2013,
                             table_RS_2014,
                             table_RS_2015,
                             table_RS_2016,
                             table_RS_2017,
                             table_RS_2018,
                             table_RS_2019,
                             table_RS_2020,
                             table_RS_2021,
                             table_RS_2022,
                             table_RS_2023,
                             table_RS_2024,
                             table_RS_2025)



# Excel


sheets <- list("N TOTAL PRINCIPAL"             = table_1TP,
               "HABITUAL TOTAL PRINCIPAL"      = table_2TP, 
               "EFETIVA TOTAL PRINCIPAL"       = table_3TP,
               
               "N TOTAL SECUNDÁRIO"            = table_1TS,
               "HABITUAL TOTAL SECUNDÁRIO"     = table_2TS, 
               "EFETIVA TOTAL SECUNDÁRIO"      = table_3TS,
               
               "N PRINCIPAL"                   = table_1P,
               "HABITUAL PRINCIPAL"            = table_2P, 
               "EFETIVA PRINCIPAL"             = table_3P,
               
               "N SECUNDÁRIO"                  = table_1S,
               "HABITUAL SECUNDÁRIO"           = table_2S, 
               "EFETIVA SECUNDÁRIO"            = table_3S,
               
               "RENDA PRINCIPAL"               = table_RP,
               "RENDA SECUNDÁRIO"              = table_RS)

writexl::write_xlsx(sheets, 
                    paste0("C:/Users/fernanda-romeiro/OneDrive - Governo do Estado do Rio Grande do Sul/Projetos/PNAD/PNAD_projetos/Dados/tabPSANOS_RS_FI_3.xlsx"))





























